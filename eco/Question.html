<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ¸›å¡‘è¡Œå‹•äº’å‹•å•ç­”</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Noto Sans TC", sans-serif;
      margin: 0;
      padding: 0;
      background: #e0f7fa;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .container {
      background: #ffffff;
      max-width: 600px;
      width: 90%;
      padding: 20px 24px;
      border-radius: 16px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
    }
    h1 {
      margin-top: 0;
      font-size: 1.6rem;
      text-align: center;
    }
    .intro {
      font-size: 0.95rem;
      color: #444;
      margin-bottom: 12px;
    }
    .input-row {
      margin-bottom: 16px;
    }
    label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }
    input[type="text"] {
      width: 100%;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 0.95rem;
    }
    .question-box {
      margin-top: 12px;
    }
    .question-title {
      font-size: 1.1rem;
      margin-bottom: 8px;
      font-weight: 600;
    }
    .question-text {
      margin-bottom: 8px;
      font-size: 1rem;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .option-btn {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #00796b;
      background: #ffffff;
      cursor: pointer;
      text-align: left;
      font-size: 0.95rem;
      transition: background 0.2s, transform 0.1s;
    }
    .option-btn:hover {
      background: #e0f2f1;
      transform: translateY(-1px);
    }
    .option-selected {
      background: #00796b;
      color: #ffffff;
    }
    .actions {
      margin-top: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    button.primary {
      padding: 8px 12px;
      border-radius: 999px;
      border: none;
      background: #00796b;
      color: #ffffff;
      font-size: 0.95rem;
      cursor: pointer;
    }
    button.primary:disabled {
      background: #999999;
      cursor: not-allowed;
    }
    .progress {
      font-size: 0.85rem;
      color: #555;
    }
    .result-box {
      margin-top: 16px;
      padding: 12px;
      border-radius: 10px;
      background: #e0f2f1;
      font-size: 0.95rem;
    }
    .status {
      margin-top: 8px;
      font-size: 0.85rem;
      color: #555;
    }

    /* é¡Œç›®æ¨™é¡Œèˆ‡ç‡ˆæ³¡ */
    .question-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .hint-btn {
      border: none;
      background: #fff3cd;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 0.8rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
    }
    .hint-box {
      margin-top: 4px;
      margin-bottom: 8px;
      padding: 8px;
      border-radius: 8px;
      background: #f1f8e9;
      font-size: 0.9rem;
      color: #333;
    }
    .hint-box ul {
      padding-left: 20px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Plastic Reduction Action | Ocean Guardian Quiz</h1>
    <h1>æ¸›å¡‘è¡Œå‹•ï½œæµ·æ´‹å®ˆè­·å°æ¸¬é©—</h1>

    <p class="intro">
      ğŸŒŸ Letâ€™s take a quick quiz to find out which â€˜Development vs. Conservationâ€™ type best matches you!<br>
      ğŸŒŸ è®“æˆ‘å€‘ä¾†åšå€‹ç°¡å–®çš„å¿ƒç†æ¸¬é©—å§ï¼çœ‹çœ‹ä½ æ˜¯å“ªç¨®ã€Œç™¼å±•èˆ‡ä¿è‚²ã€é¡å‹ï¼
    </p>

    <div class="input-row">
      <label for="userName">Nickname / Seat Number</label>
      <input type="text" id="userName" placeholder="3, Lilyâ€¦" />
    </div>

    <div id="quizArea"></div>

    <div class="actions">
      <div class="progress" id="progressText">1 / 5</div>
      <button class="primary" id="nextBtn" disabled>Next</button>
    </div>

    <div class="result-box" id="resultBox" style="display:none;"></div>
    <div class="status" id="statusText"></div>
  </div>

  <script>
    const GAS_URL =
      "https://script.google.com/macros/s/AKfycbxC-OG6rbAwSCzoQESEiQeLpLyI39_nh54McjWfhSC0Z5O9brTUXMvwaqxk32q7CrVT/exec";

    const RESULT_IMAGE_URLS = {
      1: "https://drive.google.com/thumbnail?id=1OtZ43YsvsRGHhjAiKqcWsG7YpaoU6bVu&sz=w1000",
      2: "https://drive.google.com/thumbnail?id=1GARMGL7Cm1fV3RsQbUHB4eRca-bDLZ0J&sz=w1000",
      3: "https://drive.google.com/thumbnail?id=1IQUBchBbZpV8d3kMyr_R4F_xlVLpSKmK&sz=w1000"
    };

    /* é¡Œç›®è³‡æ–™ï¼ˆè‹±æ–‡ï¼‹ä¸­æ–‡ï¼‰ */
    const questions = [
      {
        textA: "How do you want the local economy to develop?",
        textB: "ä½ å¸Œæœ›ç’°å¢ƒçš„ç¶“æ¿Ÿç™¼å±•å¦‚ä½•ï¼Ÿ",
        options: [
          { textA: "ï¼¡. Make as much money as possible, prioritizing business.", textB: "è¶Šè³ºéŒ¢è¶Šå¥½ï¼Œå•†æ¥­æ´»å‹•å„ªå…ˆ", value: 1 },
          { textA: "ï¼¢. It doesnâ€™t have to earn that much, as long as the environment stays clean.", textB: "ä¸ç”¨å¤ªè³ºéŒ¢ï¼Œä½†ç’°å¢ƒè¦ä¿æŒä¹¾æ·¨", value: 0 }
        ]
      },
      {
        textA: "If a very profitable mall could be built by the sea, what would you prefer?",
        textB: "å¦‚æœæµ·é‚Šèƒ½è“‹ä¸€å€‹å¾ˆè³ºéŒ¢çš„å•†å ´ï¼Œä½ æœƒå¸Œæœ›ï¼Ÿ",
        options: [
          { textA: "ï¼¡. Build it! Earning money is the most important.", textB: "è“‹ï¼æœ‰è³ºéŒ¢æœ€é‡è¦", value: 1 },
          { textA: "ï¼¢. Donâ€™t build it. Keeping marine animals safe matters more.", textB: "å…ˆä¸è¦ï¼Œè®“æµ·æ´‹å‹•ç‰©å®‰å…¨æ¯”è¼ƒé‡è¦", value: 0 }
        ]
      },
      {
        textA: "You are buying a drink. Choose: sealed plastic cup or reusable cup?",
        textB: "ä½ ä»Šå¤©è²·é£²æ–™ï¼Œåº—å®¶å•ä½ å°è†œæˆ–è‡ªå¸¶æ¯ï¼Œä½ æœƒé¸ï¼Ÿ",
        options: [
          { textA: "ï¼¡. Plastic sealed cup. Fast and convenient.", textB: "å°è†œæœ€å¿«ã€æœ€æ–¹ä¾¿", value: 1 },
          { textA: "ï¼¢. Reusable cup to reduce waste.", textB: "è‡ªå¸¶æ¯æ¯”è¼ƒä¸æœƒè£½é€ åƒåœ¾", value: 0 }
        ]
      },
      {
        textA: "For a class field trip, which transportation do you prefer?",
        textB: "ç­ç´šæˆ¶å¤–æ•™å­¸è¦é¸äº¤é€šå·¥å…·ï¼Œä½ åå¥½ï¼Ÿ",
        options: [
          { textA: "ï¼¡. Tour bus â€” least tiring, saves time.", textB: "éŠè¦½è»Šï¼Œæœ€ä¸ç´¯æœ€çœæ™‚", value: 1 },
          { textA: "ï¼¢. Walking or MRT â€” lower emissions.", textB: "æ­¥è¡Œæˆ–æ·é‹ï¼Œæ¸›å°‘æ’æ”¾æ¯”è¼ƒå¥½", value: 0 }
        ]
      },
      {
        textA: "If you find a usable plastic bag, what would you do?",
        textB: "å¦‚æœä½ æ’¿åˆ°ä¸€å€‹é‚„èƒ½ç”¨çš„å¡‘è† è¢‹ï¼Œä½ æœƒï¼Ÿ",
        options: [
          { textA: "ï¼¡. Throw it away â€” it's cheap anyway.", textB: "ä¸Ÿæ‰ï¼Œåæ­£å¾ˆä¾¿å®œ", value: 1 },
          { textA: "ï¼¢. Keep and reuse it.", textB: "ç•™ä¸‹ä¾†é‡è¤‡ä½¿ç”¨", value: 0 }
        ]
      }
    ];

    let currentIndex = 0;
    let answers = [];
    let selectedValue = null;
    let startTime = Date.now();
    const sessionId = "sess_" + Math.random().toString(36).slice(2);

    const quizArea = document.getElementById("quizArea");
    const progressText = document.getElementById("progressText");
    const nextBtn = document.getElementById("nextBtn");
    const resultBox = document.getElementById("resultBox");
    const statusText = document.getElementById("statusText");
    const userNameInput = document.getElementById("userName");

    /* ------------------ é¡Œç›®é¡¯ç¤º ------------------ */
    function renderQuestion() {
      const q = questions[currentIndex];
      quizArea.innerHTML = "";

      const qBox = document.createElement("div");
      qBox.className = "question-box";

      const header = document.createElement("div");
      header.className = "question-header";

      const title = document.createElement("div");
      title.className = "question-title";
      title.textContent = "Question " + (currentIndex + 1);

      const hintBtn = document.createElement("button");
      hintBtn.className = "hint-btn";
      hintBtn.innerHTML = "ğŸ’¡";

      header.appendChild(title);
      header.appendChild(hintBtn);

      const qText = document.createElement("div");
      qText.className = "question-text";
      qText.textContent = q.textA;

      const hintBox = document.createElement("div");
      hintBox.className = "hint-box";
      hintBox.style.display = "none";

      hintBox.innerHTML = `
        <div>${q.textB}</div>
        <ul>
          <li>A. ${q.options[0].textB}</li>
          <li>B. ${q.options[1].textB}</li>
        </ul>
      `;

      hintBtn.addEventListener("click", () => {
        hintBox.style.display = hintBox.style.display === "none" ? "block" : "none";
      });

      const optionsDiv = document.createElement("div");
      optionsDiv.className = "options";

      q.options.forEach(opt => {
        const btn = document.createElement("button");
        btn.className = "option-btn";
        btn.textContent = opt.textA;
        btn.onclick = () => {
          selectedValue = opt.value;
          [...optionsDiv.children].forEach(b => b.classList.remove("option-selected"));
          btn.classList.add("option-selected");
          nextBtn.disabled = false;
        };
        optionsDiv.appendChild(btn);
      });

      qBox.appendChild(header);
      qBox.appendChild(qText);
      qBox.appendChild(hintBox);
      qBox.appendChild(optionsDiv);
      quizArea.appendChild(qBox);

      progressText.textContent = (currentIndex + 1) + " / " + questions.length;
      nextBtn.textContent = currentIndex === questions.length - 1 ? "Result" : "Next";
      nextBtn.disabled = true;
      selectedValue = null;
    }

    /* ------------------ åˆ†é¡é‚è¼¯ ------------------ */
    function calcType(answers) {
      const count1 = answers.filter(v => v === 1).length;
      let type, desc;

      if (count1 >= 4) {
        type = 1;
        desc = `ä½ åå‘ã€Œé«˜ç¶“æ¿Ÿç™¼å±•ï¼Œç”Ÿç‰©é€æ¼¸å—å®³ã€é¡å‹ï¼Œé‡è¦–æ–¹ä¾¿èˆ‡è³ºéŒ¢ï¼Œå°æ¸›å¡‘èˆ‡ä¿è‚²çš„è¦æ±‚è¼ƒä½ã€‚<br>
You tend toward the â€œHigh Economic Growth, Environmental Impactâ€ type. You prioritize convenience and profit, and place relatively low emphasis on plastic reduction and conservation.`;
      }
      else if (count1 >= 2) {
        type = 2;
        desc = `ä½ åå‘ã€Œå¶çˆ¾ç’°ä¿ï¼Œæ…‹åº¦ä¸­é–“ã€é¡å‹ï¼Œæœ‰æ™‚æœƒç‚ºç’°å¢ƒåšé¸æ“‡ï¼Œä½†ä¹Ÿå¸¸ç‚ºäº†æ–¹ä¾¿è€Œå¦¥å”ã€‚<br>
You tend toward the â€œOccasionally Eco-Friendly, Middle-Groundâ€ type. You sometimes make environmentally friendly choices, but often compromise when convenience is involved.`;
      }
      else {
        type = 3;
        desc = `ä½ åå‘ã€Œä½ç™¼å±•ä½†ç”Ÿç‰©ä¿è‚²å„ªè‰¯ã€é¡å‹ï¼Œé¡˜æ„ç‚ºæµ·æ´‹ç”Ÿç‰©èˆ‡ç’°å¢ƒå“è³ªåšå‡ºå–æ¨ã€‚<br>
You tend toward the â€œLow Development, Strong Conservationâ€ type. You are willing to make trade-offs for marine life protection and environmental quality.`;
      }

      return { type, desc, count1 };
    }

    /* ------------------ ä¸Šå‚³åˆ° GAS ------------------ */
    async function submitToGAS(result) {
      const payload = {
        sessionId,
        userName: userNameInput.value || "",
        answers,
        type: result.type,
        timeUsedMs: Date.now() - startTime
      };

      statusText.textContent = "Uploadingâ€¦";

      try {
        const res = await fetch(GAS_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();
        statusText.textContent = data.status === "ok" ? "âœ… Uploaded" : "âš ï¸ Upload failed";
      } catch (e) {
        statusText.textContent = "âš ï¸ Network error";
      }
    }

    /* ------------------ é¡¯ç¤ºçµæœ ------------------ */
    function showResult() {
      const result = calcType(answers);
      const imgUrl = RESULT_IMAGE_URLS[result.type];

      resultBox.style.display = "block";
      resultBox.innerHTML = `
        <div><strong>ä½ çš„é¡å‹ï¼šç¬¬ ${result.type} é¡</strong></div>
        <div style="margin-top:6px;">${result.desc}</div>
        <div style="margin-top:8px; text-align:center;">
          <img src="${imgUrl}" style="max-width:100%; border-radius:12px;">
        </div>
      `;

      submitToGAS(result);
    }

    /* ------------------ ä¸‹ä¸€é¡ŒæŒ‰éˆ• ------------------ */
    nextBtn.onclick = () => {
      if (selectedValue === null) return;
      answers[currentIndex] = selectedValue;

      if (currentIndex < questions.length - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        quizArea.innerHTML = "";
        progressText.textContent = "Done";
        nextBtn.disabled = true;
        showResult();
      }
    };

    renderQuestion();
  </script>
</body>
</html>
